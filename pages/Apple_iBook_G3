Mi Apple es un iBook G3 fabricado en 1999, cuya primera instalación de Mac OS 8.6 se hizo el 14 de Septiembre de 1999 a las 19:55. 

== Hardware ==
Tiene un procesador PowerPC 750 a 300 MHz y 3.3 GB de HDD, AirPort y ATI Rage 128 (8 MB).
Usa módulos de memoria RAM habituales en PCs portátiles, [http://es.wikipedia.org/wiki/SO-DIMM SO-DIMM] PC100 (144 pines). Al ser la primera serie de iBooks, la RAM integrada en placa es de 32 MB (no 64 como en modelos posteriores). Tiene instalado un módulo de 32 MB, haciendo un total de 64 MB. Con esta cantidad, Mac OS 9 tarda 1'22" en arrancar y utiliza 21 MB (47 libres).

== S.O. ==
Voy a probar a instalar diferentes sistemas operativos, por el placer de experimentar y evaluar someramente el rendimiento que proporciona cada uno de ellos.
Dispongo además de:
* [http://marc-abramowitz.com/mac-os-x-switch-guide/ Mac OS X] 10.3 Panther CD1 , que no arranca
* Mac OS 9.1 Español , que no arranca
* Mac OS 9 International English , CD-bootable
* Debian 4.0-etch-ppc , CD-bootable
* NetBSD 3.1-macppc , bootable desde OF

Mac OS 9 es el más antiguo, y no proporciona multitarea ni protección de memoria. Además, no puedo instalar Darwin, ya que el archivo ISO está en formato CDR. Este formato en realidad es una partición HFS+ y no puedo grabarlo (temo desperdiciar OTRO CD).
Los Mac OS 9 son imágenes .toast obtenidas de BitTorrent.

== Actualizar Firmware ==
Tras ejecutar el programa de actualización (para Mac OS 9.1), apago y al encender mantengo pulsados command (manzana) y power hasta que se oiga un tono (no el "chime", un tono). entonces suelto. La version actual es la 4.1.7f4 .

*http://docs.info.apple.com/article.html?artnum=86117

== OpenFirmware ==
Es la BIOS. Existe en IBM RISC, Apple y Sun.
Durante el power-on se oye una campanita, ''the chime''. Se cambian diferentes opciones del arranque pulsando teclas. Para entrar al menú pulsar command+option+O+F . Para saber qué version de firmware hay:
 0 > dev /openprom
 0 > .properties

Resetear con CTRL+command+power o si podemos escribir, con reset-all .

*http://homepages.gold.ac.uk/suzanne/startup.html

Reiniciar las variables alteradas de la nvram con command+option+P+R

> setenv oem-banner your message
 > setenv oem-banner? true

=== Cambiar la hora ===
Para ajustar el reloj a 7 segundos pasadas las 11:15PM del 31 de Diciembre de 2005, poner:

 0 > decimal dev rtc 07 15 23 31 12 2005 set-time

*http://www.macosxhints.com/article.php?story=20060814075952448

=== Arranque de otro OS desde CD ===

Si estamos en el entorno gráfico, meter el CD e ir a System Folder-Control Panels-Startup Disk.

Si estamos reiniciando pulsar C para arrancar desde CD. En modo interactivo de OF, arrancar desde CD:
 0 > printenv boot-device
 0 > boot cd:,\\:tbxi

*http://www.kernelthread.com/mac/osx/arch_boot.html
*http://www.firmworks.com/QuickRef.html

=== Arranque de otro OS desde HDD ===
Descargarse ftp://ftp.es.debian.org/debian/dists/etch/main/installer-powerpc/current/images/powerpc/hd-media/ y meterlos en Mac HD (en el raíz). Iniciar al firmware y desde ahí
 boot hd:5,yaboot
Buscará una ISO para continuar la instalación.

=== Arranque de otro OS desde red ===
Elegir Network boot, pulsar N o en el firmware escribir boot enet:0,yaboot
Averiguar la MAC levantando el teclado, o con:
 0 > dev enet .properties
En el equipo que sirve el SO, instalar:
 # apt-get install inetutils-inetd tftp tftpd
En /etc/inetd.conf :
 tftp dgram udp wait root /usr/sbin/tcpd /usr/sbin/in.tftpd /tftpboot
En /etc/dhcp3/dhcpd.conf :
 option domain-name-servers 80.58.61.250;
 option subnet-mask 255.255.255.0;
 default-lease-time 600;
 max-lease-time 7200;
 
 subnet 10.0.0.0 netmask 255.255.255.0 {
   range 10.0.0.2 10.0.0.10;
   option routers 10.0.0.1;
 }
 
 host nombredecliente {
   filename "/tftpboot/yaboot";
   server-name "shiryu";
   next-server shiryu;
   hardware ethernet 00:0A:27:8B:A3:78;
   fixed-address 10.0.0.2;
 }
Descargarse el contenido de todo ftp://ftp.es.debian.org/debian/dists/etch/main/installer-powerpc/current/images/powerpc/netboot/ en /tftpboot .

Comprobamos que funciona:
# nmap -sU localhost #puerto 69
# tftp localhost
tftp> get yaboot
Received 150132 bytes in 0.1 seconds
tftp> quit

En la FAQ de netbsd hay buenos consejos.

== Debian ==

Información de versión:
*http://www.us.debian.org/releases/stable/powerpc/
Manual:
*http://www.us.debian.org/ports/powerpc/
Páginas de instalación:
*http://www.us.debian.org/ports/powerpc/inst/install

=== Instalación base ===
Particionar automáticamente. El Mac puede tener tantas particiones primarias como se quiera, pero una de ellas debe ser una tabla de particiones Apple (32 KB), y otra debe ser una partición de arranque (1 MB). A partir de ahí, podemos alojar nuestras particiones Linux, que serán una / (3 GB) y una swap. El sistema de archivos debe ser ReiserFS, XFS o ext2/3 (los soportados por yaboot). Elijo XFS.
*http://www.debian-administration.org/articles/388

=== Personalizaión ===

Repositorios:
 deb ftp://ftp.rediris.es/debian/ etch main non-free contrib
 # deb http://security.debian.org/ etch/updates main non-free contrib
 deb http://www.debian-multimedia.org etch main
 # dpkg-reconfigure console-data

*http://packages.debian.org/stable/


 # apt-get install pciutils alsa-base gpm pbbuttonsd

http://pbbuttons.berlios.de/
pbbcmd
gtkpbbuttons -a /dev/tty10
---> no accede al controlador del brillo (brightness controller not found)

http://sourceforge.net/search/?words=backlight+controller&sort=posted_date&sortdir=desc&offset=10&group_id=47862&type_of_search=mlists&pmode=0
There is a small issue with pbbuttonsd and kernel version 2.6.18.

Adjusting the LCD brightness works *only* when compiled with the new
option:
CONFIG_FB_RADEON_BACKLIGHT=y

This is fixed with kernel option:
CONFIG_PMAC_BACKLIGHT_LEGACY=y


http://tstotts.net/linux/gentoopb.html#d3e402a1900


El sistema de ventanas y un escritorio KDE mínimo.
 # apt-get install xserver-xorg xfonts-base kdebase #o bien gnome-core

teclas http://seb.france.free.fr/linux/ibookG4/iBookG4-howto-9.html#ss9.5

# deborphan --guess-all > kde
# for i in `cat kde`; do apt-get remove --purge -y $i; done;

== NetBSD ==
Este BSD está centrado en portabilidad pero su instalación es bastante tediosa.
NetBSD no puede hacer las particiones por sí mismo. Hay que prepararlas previamente con el CD de Mac OS 9. Como mínimo, preparar las siguientes particiones:
# HFS+ que contiene el bootloader. Asignarla el tamaño mínimo, 32 MB.
# HFS+ sobre la que crearemos el área de intercambio de unos 128 MB
# HFS+ sobre la que escribiremos /. Tamaño restante.

ftp://ftp.es.netbsd.org/pub/NetBSD/NetBSD-3.1/macppc/

Descargar ofwboot.xcf de installation y netbsd-GENERIC_MD* de binary.


en of:
boot hd:9,ofwboot.xcf cd:,/macppc/binary/kernel/netbsd-GENERIC_MD.gz

boot cd:,ofwboot.xcf netbsd.macppc

El proceso está guiado por unos simples menús y puede interrumpirse en cualquier momento y realizarse desde una shell, para los usuarios más avanzados.
Seleccionar el sistema mínimo (ocupará 78 MB en disco) con el núcleo, utilidades base y configuración (/etc). A continuación, en disklabel, escoger las particiones reservadas anteriormente y formatearlas:
# la mayor que montará /, nuevo sistema de archivos FFSv1 (de 32 bits, el v2 es de 64), opciones de montaje softdep.
# la siguiente, que será swap

Tras la instalación, puede eliminarse (set false) el auto-boot de OF (ver variables). El arranque del sistema se hace mediante:
 0 > boot hd:9,ofwboot.xcf
En el arranque /etc/rc.conf no está preparado por lo tanto caemos en single user.
 # mount -a
 # vi /etc/rc.conf #valores por defecto en /etc/defaults/rc.conf
 rc_configured=YES
 sendmail=NO #opcional
 inetd=NO #opcional
 hostname="hyoga" #opcional
 # exit

Inicialmente hay 40MB libres.
Es parecidísimo a FreeBSD, con ttys, sendmail, rc.conf ... El arranque es extremadamente rápido, 29 segundos hasta el login.
NetBSD utiliza intensamente las capacidades de consola del OF, y es un poco lento (falta una opcion de compilación). Es mejor usar una telnet para administrar rápidamente:
Consola telnet:
 editar inetd.conf y quitar -a valid de la descomentada linea telnet ipv4
 editar ttys y añadir un terminal seguro getty Pc ttyp0 vt220

Reejecutamos el instalador, y añadimos los sets de X11. Como sólo queremos ese set, desmarcamos el resto.
 # xf86config
 ratón tipo 1 (wsmouse)
 # startx
Oops! Error.
 # tail /var/log/XFree86.0.log
 # vi /etc/X11/XF86Config
 Option "Protocol" "wskbd"
 Option "Device" "/dev/wskbd0"
Ahora sí. TWM!!

Una vez contentos y satisfechos, fijamos el arranque definitivo para NetBSD en OF:
 0 > setenv auto-boot? true
 0 > setenv boot-device hd:9,ofwboot.xcf
 0 > reset-all

FAQ oficial:
*http://www.netbsd.org/ports/macppc/faq.html

Manual oficial:
*ftp://ftp.es.netbsd.org/pub/NetBSD/NetBSD-3.1/macppc/INSTALL.html#Getting%20to%20Open%20Firmware%20(Without%20using%20MacOS)

Experiencias de otros usuarios:
*http://mauroandres.wordpress.com/2007/04/18/netbsd-macppc-install/
*http://64.233.183.104/search?q=cache:3frJS7MA3QIJ:www.corralito.org/unix4all/%3Fp%3D11+toad+mac+netbsd&hl=es&ct=clnk&cd=3&gl=es&client=firefox-a

== De vuelta a Mac OS ==
Para sacar el mejor partido al equipo le instalaremos Mac OS 9, la última versión de la familia Mac clásica. Bajo este OS el hardware funciona al completo: todas las teclas de función, hibernación
No se puede instalar directamente el disco en español:
ni traducir el sistema, ni instalar updates en otro idioma
, ni tampoco una vez instalado en inglés en una única partici
La única solución, sin sacar el disco y conectarle a otro Mac idéntico
Como tampoco es posible, lo que haremos será instalar meter instalador CD Mac-inglés desde cero, dividiendo el HD en 2 particiones idénticas. Despúés arrancaremos en el sistema recién instalado. Ahora meteremos el CD en español, y ejecutaremos el instalador, pero como destino especificaremos la partición que tenemos vacía.
arrancará desde él

Programas:
*[http://docs.info.apple.com/article.html?artnum=75288 Actualizaciones hasta 9.2.2]
*[http://browsers.evolt.org/?ie/mac/5.1.7_Classic Explorer 5.1.7 Explorer 5.1.7]
*[http://docs.info.apple.com/article.html?artnum=120073 iTunes 2.0.4]
*[http://www.microsoft.com/mac/downloads.aspx#Messenger Messenger 2.5.1 y Outlook 5.0.6]