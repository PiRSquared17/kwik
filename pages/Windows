== Activar Windows ==
Los Windows pirata se quejan mediante unas llaves de su condición ilegítima. Para tener acceso a actualizaciones y programas le activamos:
#Regedit -> HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\WPAevents
#modificar cualquier byte de OOBETimer
#ejecutar: %systemroot%\system32\oobe\msoobe.exe /a
#activar por teléfono y meter la siguiente clave, cortesía de CIC: G3GDT-W79YV-HF39X-Y4H2C-YQV96
*http://209.85.135.104/search?q=cache:U2pFp-rYJu0J:searchwincomputing.techtarget.com/tip/0,289483,sid68_gci1109890,00.html+regedit+windows+activation+oobe&hl=es&client=firefox-a&gl=es&strip=1

== Acelerar NTFS ==
NTFS tiene características de seguridad y menos fragmentación que FAT no tiene, pero por contra exige más CPU. Desactivemos la actualización de accesos a disco:
 HKLM/System/CurrentControlSet/Control/Filesystem
  NtfsDisableLastAccessUpdate DWORD 1

== No arranca pues falta un archivo ==
Se queda en modo texto indicando que C:\Windows\System32\c_850.nls está dañado. Iniciamos consola de recuperación con el CD de Windows. Ahora buscamos este archivo del CD y le llevamos a su ubicación.
 expand g:i386\c_850.nl_ system32
El guión bajo es ALT+095

== Formateo e instalación en 30 minutos ==
Cogemos una instalación de Win a la que hemos sustituido el driver del HDD por uno genérico, e instalamos Partition Magic.
Ponemos en ese PC el disco duro al que queramos instalar el SO.
Metemos el CD de Knoppix y en una shell escribimos:
 # dd if=/dev/hda of=/dev/hdb count=1 bs=512
 # dd if=/dev/hda1 of=/dev/hdb1 bs=8k
Podemos ver la tabla de particiones con cfdisk. Comprobar antes de efectuar la copia de datos que la partición existe. Si no fuera así, crearla a mano, con idénticos límites que la otra. Será necesario reiniciar para que relea la tabla.  En caso de que los discos duros tengan un tamaño distinto, es imperativo crear la partición a mano, de lo contrario los límites no coincidirían.

Si tenemos que reconstruir el MBR, iniciar grub interactivamente:
 # grub
 grub> root (hd0,0)
 grub> setup (hd0)
 grub> quit
Se usa la notación de particiones de GRUB (hdb3 sería hd1,2). Primero se indica qué partición contiene el directorio /boot, y después dónde queremos instalar el MBR.

== Agregar o quitar programas no funciona ==
No funciona Windows Installer, ni aun iniciando manualmente el servicio (pop-up de error).
Instalar SP4 para que funcione.
Después ejecutar estos comandos con el CD de instalación:
 expand E:\i386\appwiz.cp_ %SystemRoot%\system32\appwiz.cpl 
 regsvr32 appwiz.cpl 
 regsvr32 /i shdocvw.dll 
 regsvr32 /i mshtml.dll 
 regsvr32 /i shell32.dll 
 regsvr32 ole32.dll
(quiza sea suficiente con las líneas de appwiz y mshtml)


== Win2000 no arranca ==
Desde una sesión en la consola de recuperación del CD de instalación, realizar:
 fixmbr c:
 fixboot c:
Asegurarse de que boot.ini contiene:
 [boot loader]
 timeout=30
 default=multi(0)disk(0)rdisk(0)partition(1)\WINDOWS
 [operating systems]
 multi(0)disk(0)rdisk(0)partition(1)\WINDOWS="Microsoft Windows XP Professional" /fastdetect /NoExecute=OptIn

Y por último, si se queda bloqueado cuando lee el disco duro, es debido a que la partición de arranque no coincide con el principio del disco. Solucionarlo mediante Partition Magic (dejar huecos sin particionar al final del disco siempre, nunca al principio).


== Crear una relación de confianza entre dos dominios de red ==
Una ‘trust relationship’ permite que los usuarios de un dominio accedan a los recursos del otro.
Primero creamos un usuario nave en ambos dominios, con la misma clave itm , y que sea administrador del dominio.
En Herramientas AdministrativasàDominios y confianzas de Active Directory hacemos click con el derecho sobre el dominio, Propiedades y en la pestaña Confía añadimos Nueva Confianza, con el dominio que sea, bidireccional, ambos dominios, click click ok ok usuario nave:itm .
Finalmente aparecerá listado el otro dominio en éste y éste en el otro.


== Piel Ubuntu-Human para XP ==
Instalar [http://www.chip.de/downloads/c1_downloads_13005628.html Uxtheme Multi-patcher 5.0], la piel [http://www.deviantart.com/deviation/37743373/ Human], los iconos [http://www.deviantart.com/deviation/27940418/ Tangerine] y la piel para [https://addons.mozilla.org/firefox/3008/ Firefox], en ese orden.

== Autologin en Windows2000 ==
Abrimos la clave del registro HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon y comprobamos que contiene los valores:
*DefaultDomainName
*DefaultUserName
*DefaultPassword
Añadimos la clave AutoAdminLogon de tipo REG_SZ con valor 1.
Más trucos en http://www.viejoblues.com/Trucos%202K%203.htm .

== Administrador de tareas bloqueado ==
Si sale un alert diciendo que el administrador de tareas lo ha bloqueado un administrador, hay que cambiar esta clave del registro:
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System
DisableTaskManager -> 0


== Apagado automático de ordenadores Windows ==
Los ordenadores de la oficina no son servidores, por lo tanto por la noche deben ser apagados.
Añadimos una nueva tarea programada, consistente en ejecutar todos los dias a las 19:40 un script llamado apagado.vbs .

 'Win32 OperatingSystem
 'http://msdn.microsoft.com/library/psdk/wmisdk/clasops 0h7x.htm
 'Sugerencia de Michael Harris.Aplicación y comentarios: Marcial Carlés.
 '
 'Atención: Este script cierra todas las tareas, el propio sistema
 'y finalmente apaga la máquina '(PowerOff).
 'Si hay archivos de datos abiertos, NO serán salvados.
 'Válido para sistemas que implementan WMI (Windows ME y 2000).
 
 Set wmi = GetObject("winmgmts:{(Shutdown)}")
 Set objSet = Wmi.InstancesOf("win32_operatingsystem")
 For Each obj In objSet
     set os = obj : exit for
 Next
 
 os.win32shutdown (12)
 
 'http://freyes.svetlian.com/tips/shutdown.htm
 'http://support.microsoft.com/default.aspx?scid=kb;ES;317371
 'http://www.microsoft.com/technet/treeview/default.asp?url=/technet/scriptcenter/scrguide/sas_cpm_gmen.asp

== Copias de seguridad automáticas ==
Mediante un procedimiento habitual en máquinas *NIX con comandos estándar, haremos backups en Windows a un medio de almacenamiento extraíble.
Descargarse las herramientas UNIX compiladas para W32 desde http://unxutils.sourceforge.net/ .
Descomprimirlo y ajustar el path C:\unix\usr\local\wbin .

Crear un fichero por lotes:
 @echo off
 rem script de copia de datos para servidor kk
 echo Realizando copias de seguridad...
 tar vcf personal.tar "D:\PERSONAL"
 gzip personal.tar
 mv personal.tar.gz H:\
 tar vcf bd.tar "C:\Basedatos"
 gzip bd.tar
 mv bd.tar.gz H:\
 echo Copia efectuada en H:
 rm pause

Añadirlo a tareas programadas, y que se ejecute "at boot".

== Tareas programadas no puede añadir una nueva ==
No es posible añadir una tarea programada, al parecer por falta de privilegios, según indica el mensaje de error.
Lo que ocurre realmente es que el administrador del sistema (sea Administrador o sea un nombre de usuario con privilegios de admin.) suele tener clave vacía en equipos monousuario. Hay que ir a Configuración de seguridad local -> Opciones de seguridad, Cuentas: limitar el uso de cuentas locales sin contraseña y deshabilitarlo.


== No navega pero sí hace ping ==
Si no navega con IPs no es problema de DNS. Debemos eliminar el protocolo TCP/IP, reiniciar, y reinstalarlo.

== Al enchufar un pendrive USB sale un mensaje ==
Este mensaje aparece en forma de globo en el systray. Viene a decir que el dispositivo podría funcionar mejor si estuviera conectado a un puerto USB 2.0 . Si nuestro sistema no tiene esos puertos, es una información innecesaria. Desactivarlo yendo a administrador de hardware, y en una pestaña de los dispositivos USB, marcar "No informar de errores USB".

== WinXP \WINDOWS\SYSTEM32\CONFIG\SYSTEM no se encuentra o está dañado ==
El sistema no arranca y dá ese error. Metemos un CD de Win2000 o XP y arrancamos con la consola de recuperación. Efectuamos:
 cd \windows\system32\config
 ren system system.bad
 copy \windows\repair\system


== Excel genera copias de seguridad por sí solo ==
Para desactivar esta característica tan molesta, ir a Guardar como... , pinchar en Herramientas (parte superior derecha) y Opciones generales. Después, cerciorarse que está desactivado Crear siempre una copia de seguridad.


== INACCESIBLE_BOOT_DEVICE en Win2000 ==
Hay dos momentos durante el proceso de arranque que pueda presentarse esta pantalla azul.
Antes del GUI (justo despues de la pantalla de boot.ini donde se elige el SO) y cuando la barra de Win2000 llega a 3/4.

En el primer caso, es cosa del driver del controlador de disco. Suele suceder al cambiar un HDD a otro PC diferente. Poner el HDD en el PC original y seleccionar unos drivers de disco genéricos. Al cambiar el disco duro de un ordenador con Win2000 a otro con una placa base distinta, se produce un pantallazo azul en el arranque. La mejor solución es poner el disco duro en el ordenador antiguo, y en administrador de dispositivos, ir al controlador IDE/ATA, doble clic, actualizar controlador, elegir manualmente de una lista el PCI doble canal de Windows, en vez de el del fabricante.
http://www.motherboard.windowsreinstall.com/problems.htm

Otra posible solución sería hacer una instalación mínima de Win2000 en la nueva máquina, y copiar el archivo C:\winnt\system32\HAL.DLL al disco duro antiguo. De este modo podrá arrancar y mantendremos la instalación Win2000 original.

En el segundo, hay que arrancar desde la interfaz de consola del CD y copiar los archivos system y software de %windir%\repair o %windir%\repair\regback a %windir%\system32.
Hacer copia de los ficheros a sustituir.
Usar regedit para editar el fichero antiguo software y buscar upperfilters y lowerfilters. Buscar un filter driver de terceros. Además, partmgr debería estar listado (algunos grabadores de CD lo quitan).
((Joe Griffin [MS]))

Estos comandos solucionan el sector de arranque del disco:
 fixmbr c:
 fixboot c:

== Licencia de Terminal Server expirada ==
Los ordenadores que se conectan por medio de TS con licenciamiento por dispositivo, si no encuentran una CAL disponible se les asigna tienen una licencia de uso temporal de 120 días. Pasado ese tiempo, no es posible usar TS de no ser que se adquieran costosas CAL o se formatee el equipo. Es posible resetear a otros 120 dias borrando la clave -HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSLicensing del ordenador cliente de TS. Hacerlo mediante un archivo .reg que contenga:
 REGEDIT4
 
 [-HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSLicensing]

''Delete the complete MSlicensing key from the client computer which tries to establish a remote session. After you delete this key, the client machine would once again be issued a temp license and it would be valid for another 90 days in case of 2003 licensing server.''

*http://support.microsoft.com/kb/187614/EN-US/
*http://support.microsoft.com/kb/823313/es
*http://www.grupoitpro.com.ar/KnowledgeBase/TerminalServer2003/tabid/140/Default.aspx

== No aparece el usuario bajo el que corre un proceso ==
En el Administrador de Tareas (Task Manager), pestaña Procesos, no tenemos información del usuario dueño del proceso. Esto es porque el Servicio de Terminal no está activado. Ir a services.msc y activarlo.


== Pijadas varias en windows ==
2000
mi pc->inicio y recuperación->mostrar la lista de sistemas op. al iniciar
XP
panel de control->cuentas de usuario->cambiar la forma en que los usuarios inician sesión
modificar a donde se dirige mis documentos
desactivar omitir subrayado hasta que se pulse alt
desactivar iconos personalizados del menu inicio
desactivar agrupar programas similares en la barra de tareas de xp

En C:\Documents and Settings\daniel\Datos de programa\Microsoft\Internet Explorer tenemos un BMP que es el Internet Explorer Wallpaper.


== Clave de spywares ==
HK_LM\SOFTWARE\Microsoft\Windows\CurrentVersion\policies\explorer\run
y quitar lo que haya
Ver también:
HKEY_CURRENT_USER\SOFTWARE\Microsoft\Internet Explorer\Main

http://support.microsoft.com/default.aspx?scid=kb;EN-US;q320159


== Icono Mostrar Escritorio ==
Si desapareciera, podemos hacer uno creando un archivo .scf que contenga:
 [Shell]
 Command=2
 IconFile=explorer.exe,3
 [Taskbar]
 Command=ToggleDesktop


== Disco de instalación/inicio de Win2000 ==
Metemos un disco de instalación de win2000. Desde una ventana msdos:
 C:\> e:
 E:\> cd BOOTDISK
 E:\> makeboot
Necesitará 4 discos de 1,44 Mbytes.


== Serial ATA drivers ==
Al instalar Win XP en un ordenador con discos SATA no nos reconoce el disco duro.
Es preciso meter los drivers pulsando F6 (SCSI o RAID de otro fabricante). Los podemos encontrar en el CD de la placa base, el cual suele ser autoarrancable.
Nota: ATA es IDE. SATA es peor que SCSI, pero aun así es bastante mejor que ATA. ATAPI es para los CDs.

== Borrar contactos al redactar correos ==
Outlook almacena temporalmente un histórico de contactos usados para redactar. Si queremos eliminar esa lista hay que borrar el archivo \Datos de Programa\Microsoft\Outlook\*.nk2

== Cambiar letra de unidades ==
A veces Windows cambia el nombre de las unidades del disco. Para poner otro, vamos a Mi PC, botón derecho, Administrar. Sale la ventana de Herramientas Administrativas.
Ahora seleccionamos el Administrador de discos, y hacemos los cambios convenientes.


== Personalizar teclado en XP ==
Para cambiar de sitio ciertas teclas o anular su función, traducimos los scancodes. Estos scancodes luego son procesados según la configuración regional.
Añadir un valor binario "Scancode Map" en     
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Keyboard Layout
Y añadir estos valores:
 0000 0000 cabecera
 0000 0000 cabecera
 0000 0200 número de cambios +1
 5600 1DE0 cambia el 0x56 (<>) por el E01D (CTRL DERECHO)
 0000 0000 terminador
Notar que se usa little endian, se invierten los bytes de los words y en los dword también.
http://www.win.tue.nl/~aeb/linux/kbd/scancodes-1.html


== Problemas migrando perfiles y correos ==
Los correos se guardan en subcarpetas colgando de C:\Document and Settings\USER .
*Outlook, en Configuración Local\Datos de Programa\Microsoft\Outlook . El almacén es un .PST con cuentas normales o un .OST con Exchange. El .OST no se puede importar, así que sin reunir al dominio, se exporta el correo a un .PST . Si diese algún fallo, nos aseguramos de que está desprotegido contra escritura, o podemos emplear C:\Archivos de programa\Archivos comunes\System\Mapi\3082\NT\SCANPST.EXE .
*Outlook Express, en Configuración Local\Datos de Programa\Identities\{KEY}\Microsoft\Outlook . El almacén son diversos .DBX que se pueden copiar tal cual.
*Thunderbird, en Configuración Local\Datos de Programa\Thunderbird\Profiles . El almacén contiene mboxes con las carpetas, índices y la propia configuración de cuentas.
Después, loguearse con el nuevo dominio (ya no se podrá regresar al perfil antiguo) y abrir una vez el programa de correo. Sustituir la carpeta o importar los datos.

== Acceso a un ordenador WinNT desde Win98 ==
Para evitar que pida la contraseña IPC$, o que no tenga acceso a la red hay que:
-loguearse en el ordenador Win98 con el cliente de redes microsoft, y especificar un usuario existente en el ordenador de destino
-en Herramientas Administrativas -> Directiva de seguridad local, buscar Denegar acceso desde la red a este equipo y quitar todo.
-en Acceso de red: dejar los permisos de todos para aplicarselos a usuarios anónimos
-en Tener acceso a este equipo desde la red, poner Todos
-en Configuración de seguridad local -> Opciones de seguridad, Cuentas: limitar el uso de cuentas locales sin contraseña y deshabilitarlo.


== Instalación de Windows desde disco ==
http://www.microsoft.com/downloads/details.aspx?familyid=83F53BE9-28FA-40E8-8EC2-631504EF5E26&displaylang=es
Centro de descargas de Microsoft. Discos de inicio de WinXP Pro SP1


== Desactivar eco entrante en el firewall de WinXP SP2 ==
Para ello, hay que quitar el puerto 445 TCP de la excepción Compartir archivos e impresoras.


== Permitir acceder con Samba a compartidos de Windows 2003 ==
Al intentar examinar un compartido obtenemos NT_STATUS_ACCESS_DENIED .

Resulta que por defecto Win2003 encripta las transmisiones. Samba no es capaz de funcionar con ello directamente, aunque tengamos encrypt passwords=yes. Los AD funcionan con Kerberos y es necesario unir la máquina al dominio (net ads join). Para evitar esto lo que hacemos es ir a Herramientas Administrativas-Directiva de seguridad del controlador de dominio-directivas locales-opciones de seguridad-servidor de red microsoft:firmar digitalmente las comunicaciones y desahabilitarlo.

Ejecutar despues en WinXP y 2003:
 gpupdate
En 2000:
 secedit /refreshpolicy MACHINE_POLICY
 secedit /refreshpolicy USER_POLICY

Truco encontrado en:
*http://www.macosxhints.com/article.php?story=20030922153448490
*http://allinthehead.com/retro/218/

Si pese a ello obtenemos NT_STATUS_TRUSTED_DOMAIN_FAILURE al examinar con Samba, es por que el dominio tiene establecida una confianza la cual no se puede resolver (no contacta con el dominio confiable). Hay que eliminar en el DC esas confianzas que no funcionan.

== Equipos no reconocen el dominio ==
Los equipos es como si no estuvieran en el dominio, el error recurrente es:
 1311    0x051F    No hay servidores de inicio de sesión disponibles para atender la petición de inicio de sesión.

La solución pasa por modificar un campo de Propiedades de Protocolo Internet (TCP/IP) -> Opciones avanzadas -> pestaña DNS -> Sufijo DNS ... y especificar el nombre del dominio ''conexion.com''. Además, el primer DNS debe ser el servidor en cuestión: 192.168.1.2 ya que de otro modo ese dominio no resuelve.

[[image: tcpdns.png]]

Esto puede suceder cuando hay dos dominios netbios con el mismo nombre siendo publicados simultáneamente en la red local.

*http://www.kernelnet.com/content/view/64/2/

== No es posible iniciar sesión en WinXP ==
Al encender un ordenador nos encontramos el menú de selección de usuario de windows, y los usuarios que aparecen tienen contraseña, con lo cual no podemos iniciar sesión en el equipo.
Valiéndonos de que el 90% de las instalaciones windows no tienen contraseña de administrador, una solución mala es reiniciar a prueba de fallos y loguearnos como admin, y cambiar la clave de uno de esos usuarios.
Una solución mejor, es pulsar CTRL+ALT+DEL en la pantalla de bienvenida y de este modo pasaremos al login clásico de Win2000. Ahora ponemos de usuario administrador.


== Inicio de sesión Win 2000 en dominio ==
El sistema no puede iniciar sesión en este dominio porque falta la cuenta de equipo en el dominio primario o la contraseña en esa cuenta no es correcta.
Iniciamos desde CD con la consola de reparación, copiamos \WINNT\Repair\sam a \WINNT\System32\Config. Eliminar sam.log de este último directorio.
Iniciar como administrador del equipo y reunir al dominio.

== Portapapeles gracias a IExplorer ==
El Javascript de una página web tiene acceso al contenido de nuestro portapapeles gracias al método:
 window.clipboard.getData("Text")
Versiones más actuales de IE suelen desactivar esta característica.

== IExplorer elementos no seguros ==
En la pestaña Seguridad, activar Mostrar contenido mixto.

== IExplorer no entra en https://distribuidores.orange.es ==
El navegador no entra en esta web segura, se queda bloqueado. Si vamos a Ayuda - Acerca de... en el popup indica que:
 Actualizar versiones: ; SP1;
Hemos de instalar ALGUNO de los parches Q832894, Q833989, Q823353, Q903235, Q837009 ó SP2 para que funcione la página (el primero es suficiente).

== Impresoras con trabajos pendientes ==
Hay impresoras eliminadas con trabajos pendientes, o que no se pueden eliminar completamente.
Abrir services.msc y detener el servicio Cola de Impresión. A continuación, reanudarlo.
Puede ser de utilidad este script .bat:
 @echo off
 echo.
 echo Purging the print queue . . .
 net stop Spooler
 echo Deleting all print jobs . . .
 ping localhost -n 4 > nul
 del /q %SystemRoot%\system32\spool\printers\*.*
 net start Spooler
 echo Done!
 ping localhost -n 4 > nul


== Comandos de red Windows ==
 C:\> net help
 C:\> net share		recursos compartidos
 C:\> net statistics server	uptime y demás estadísticas
 C:\> net session		usuarios conectados, permite realizar acciones como desconectarles
 C:\> net send		envía un mensaje a otros usuarios que hayan activado el servicio Mensajero
 C:\> net stop browse	detener el servicio de examinador de equipos de la red
				rearrancarle para que funcione
 C:\> ntbstat –A 192.168.1.61	nombre netbios de ese host

Para ver qué y quienes están usando nuestro equipo o servidor poner fsmgmt.msc.
Hay que destacar que por defecto Windows comparte las unidades locales con el nombre C$ (D$ y sucesivamente). Estos shares no se muestran en Windows al explorar debido al $, pero sí están compartidos (con propósitos administrativos dice XP...).
http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/net_stop.mspx

Comandos extra de Windows:
*http://informatica-practica.net/trucos/menus-ocultos-comandos-windows-xp.php